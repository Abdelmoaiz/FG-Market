const DataStore=require("nedb"),items=new DataStore({filename:"db/myItems.db",autoload:!0}),invoice=new DataStore({filename:"db/myInvoice.db",autoload:!0}),invoicebuy=new DataStore({filename:"db/myInvoiceBuy.db",autoload:!0}),purchases=new DataStore({filename:"db/myPurchases.db",autoload:!0}),clients=new DataStore({filename:"db/myClients.db",autoload:!0}),retuenInvoice=new DataStore({filename:"db/myetuenInvoice.db",autoload:!0}),expenses=new DataStore({filename:"db/myExpenses.db",autoload:!0}),user=new DataStore({filename:"db/myUser.db",autoload:!0}),suppliers=new DataStore({filename:"db/mySuppliers.db",autoload:!0}),partner=new DataStore({filename:"db/myPartner.db",autoload:!0}),customer=new DataStore({filename:"db/myCustomer.db",autoload:!0}),{ipcMain:ipcMain}=require("electron");items.loadDatabase(),invoice.loadDatabase(),invoicebuy.loadDatabase(),purchases.loadDatabase(),clients.loadDatabase(),retuenInvoice.loadDatabase(),expenses.loadDatabase(),suppliers.loadDatabase(),customer.loadDatabase(),partner.loadDatabase(),user.loadDatabase(),console.log("server is running with database"),ipcMain.on("allUsers",((e,i)=>{user.insert(i),e.sender.send("data-created",JSON.stringify(i))})),ipcMain.on("newInvoiceBuy",((e,i)=>{invoicebuy.insert({newInvoiceBuy:i}),e.sender.send("newInvoiceBuy",JSON.stringify(i))})),ipcMain.on("get-invoiceSup",((e,i)=>{invoicebuy.find({},((e,i)=>{ipcMain.on("get-invoiceSup",((e,n)=>{e.sender.send("get-invoiceSup",JSON.stringify(i))}))}))})),ipcMain.on("update-invoiceSup",((e,i)=>{invoicebuy.update({_id:i.tmpId},i)})),ipcMain.on("update-invoiceSup",((e,i)=>{invoicebuy.update({_id:i.idSelect},i)})),ipcMain.on("update-InvoiceSup",((e,i)=>{invoicebuy.update({_id:i.tmpIdUpdate},i)})),ipcMain.on("return-items",((e,i)=>{invoicebuy.update({_id:i.tmpItems},i)})),ipcMain.on("delete-InvoiceSup",((e,i)=>{invoicebuy.remove({_id:i},{},((e,i)=>{}))})),ipcMain.on("newItems",((e,i)=>{items.insert({myItems:i}),e.sender.send("newItems",JSON.stringify(i))})),ipcMain.on("get-Data",((e,i)=>{items.find({},((e,i)=>{ipcMain.on("get-Data",((e,n)=>{e.sender.send("get-Data",JSON.stringify(i))}))}))})),ipcMain.on("update-items",((e,i)=>{items.update({_id:i.tmp},{myItems:i})})),ipcMain.on("delete-items",((e,i)=>{items.remove({_id:i},{},((e,i)=>{}))})),ipcMain.on("insert-return",((e,i)=>{retuenInvoice.insert(i),e.sender.send("returnInvoice",JSON.stringify(i))})),ipcMain.on("newInvoice",((e,i)=>{invoice.insert({myInvoice:i}),e.sender.send("newInvoice",JSON.stringify(i))})),ipcMain.on("update-items2",((e,i)=>{items.update({_id:i.idSelect},{myItems:i})})),ipcMain.on("update-items3",((e,i)=>{items.update({_id:i.tmpId},{myItems:i})})),ipcMain.on("return-items2",((e,i)=>{items.update({_id:i.idData},{myItems:i})})),ipcMain.on("return-invoice",((e,i)=>{invoice.update({_id:i.idSel},i)})),ipcMain.on("get-Invoice",((e,i)=>{invoice.find({},((e,i)=>{ipcMain.on("get-Invoice",((e,n)=>{e.sender.send("get-Invoice",JSON.stringify(i))}))}))})),ipcMain.on("newExpenses",((e,i)=>{expenses.insert(i),e.sender.send("newExpenses",JSON.stringify(i))})),ipcMain.on("newClient",((e,i)=>{clients.insert({myClientInvoice:i}),e.sender.send("newClient",JSON.stringify(i))})),ipcMain.on("get-clientInvoice",((e,i)=>{clients.find({},((e,i)=>{ipcMain.on("get-clientInvoice",((e,n)=>{e.sender.send("get-clientInvoice",JSON.stringify(i))}))}))})),ipcMain.on("update-invoice",((e,i)=>{clients.update({_id:i.tmpId},i)})),ipcMain.on("update-invoice2",((e,i)=>{clients.update({_id:i.idClientMain},i)})),ipcMain.on("mySuppliers",((e,i)=>{suppliers.insert({mySuppliers:i})})),ipcMain.on("get-suppliers",((e,i)=>{suppliers.find({},((e,i)=>{ipcMain.on("get-suppliers",((e,n)=>{e.sender.send("get-suppliers",JSON.stringify(i))}))}))})),ipcMain.on("update-suppliers",((e,i)=>{suppliers.update({_id:i.tmp},{mySuppliers:i})})),ipcMain.on("delete-suppliers",((e,i)=>{suppliers.remove({_id:i},{},((e,i)=>{}))})),ipcMain.on("myCustomer",((e,i)=>{customer.insert({mySuppliers:i})})),ipcMain.on("get-Customer",((e,i)=>{customer.find({},((e,i)=>{ipcMain.on("get-Customer",((e,n)=>{e.sender.send("get-Customer",JSON.stringify(i))}))}))})),ipcMain.on("update-Customer",((e,i)=>{customer.update({_id:i.tmp},{myCustomer:i})})),ipcMain.on("delete-Customer",((e,i)=>{customer.remove({_id:i},{},((e,i)=>{}))})),ipcMain.on("myPartner",((e,i)=>{partner.insert({myPartner:i})})),ipcMain.on("get-Partner",((e,i)=>{partner.find({},((e,i)=>{ipcMain.on("get-Partner",((e,n)=>{e.sender.send("get-Partner",JSON.stringify(i))}))}))})),ipcMain.on("update-Partner",((e,i)=>{partner.update({_id:i.tmpId},i)})),ipcMain.on("delete-Partner",((e,i)=>{partner.remove({_id:i},{},((e,i)=>{}))}));